"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var addons_1 = __importDefault(require("@storybook/addons"));
var core_events_1 = require("@storybook/core-events");
var constants_1 = require("./constants");
addons_1.default.register(constants_1.ADDON_ID, function (api) {
    var channel = api.getChannel();
    var onUpdate = function () {
        var path = api.getUrlState().path;
        var message = JSON.stringify({
            method: constants_1.UPDATE,
            payload: { path: path },
        });
        window.parent.postMessage(message, '*');
    };
    channel.on(core_events_1.STORY_CHANGED, onUpdate);
    channel.on(constants_1.UPDATE, onUpdate);
});
